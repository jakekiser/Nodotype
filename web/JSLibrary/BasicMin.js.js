function fValidateForm(event,oForm,ajaxMode){var bError=0;bError=0;var pars=oForm.getElementsByTagName('input');bError=fCheckForErrors(pars);if(bError==0){pars=oForm.getElementsByTagName('textarea');bError=fCheckForErrors(pars)}if(bError==1){return false}pars=oForm.getElementsByTagName('input');for(var i=0;i<pars.length;i++){if(pars[i].className.indexOf('xf_UpdInd')!=-1){pars[i].value=1}}for(i=0;i<pars.length;i++){if(pars[i].name.indexOf('formModeInd')!=-1){for(var i2=0;i2<pars.length;i2++){if(pars[i2].className.indexOf('xf_UpdMode')!=-1){pars[i2].value=pars[i].value}}}}if(ajaxMode!='1'){oForm.submit()}else{fSaveBasicPage(event,oForm.id)}}function fCheckForErrors(pars){var bError=0;var bFieldsRequired=0;var bWrongEmailFormat=0;var bCredentialsMatchIssue=0;for(var i=0;i<pars.length;i++){pars[i].className=pars[i].className.replace('formError','')}for(var i=0;i<pars.length;i++){if(pars[i].className.indexOf('xf_Required')!=-1&&pars[i].value.length<1){pars[i].className=pars[i].className+' formError';bError=1;bFieldsRequired=1}if(pars[i].className.indexOf('xf_Email')!=-1&&pars[i].value.length>0&&!isValidEmail(pars[i].value)){pars[i].className=pars[i].className+' formError';bError=1;bWrongEmailFormat=1}if(pars[i].className.indexOf('xf_CredentialsMatch')!=-1&&pars[i].value!=document.getElementById('Password').value){pars[i].className=pars[i].className+' formError';bError=1;bCredentialsMatchIssue=1}}if(bError==1&&bFieldsRequired==1){alert('Fields are required')}if(bError==1&&bCredentialsMatchIssue==1){alert('Passwords do not match')}if(bError==1&&bWrongEmailFormat==1){alert('Email field found that is an incorrect format')}return bError}var RSSPollTimer;function RSSPollTimer(){if(document.getElementById('RSSPoll')){RSSPollTimer=window.setInterval('RSSPollAjax()',10000)}}function RSSPollAjax(){$("#RSSPoll").load("/OXPFUNCS.php?FUNC=RSSPOLL")}function fCheckVal(elem){if(elem.checked){elem.value='1'}else{elem.value=0}}function fToggle(elemId){if(document.getElementById(elemId).style.display=='none'){document.getElementById(elemId).style.display=''}else{document.getElementById(elemId).style.display='none'}}function fDelPage(pid){var x=window.confirm('You are about to delete an XPage\n\n if correct, press OK, else CANCEL');if(!x){return}$.get('/OXP_DELPAGE?pid='+pid);$('#Row_'+pid).removeAttr("style").fadeOut()}function fDelFile(fid,pType){var x=window.confirm('You are about to delete a file\n\n if correct, press OK, else CANCEL');if(!x){return}$.get('/OXPFUNCS.php?FUNC=DELFILE&FileId='+fid+'&Type='+pType);$('#FileRow_'+fid).removeAttr("style").fadeOut()}function fSortPages(eId,mode){try{$(eId).sortable("destroy")}catch(e){};fHideElems('XPageDoc');$('#XPageSortDoc').fadeIn(1000);if(mode==0){$(eId).sortable({axis:"y"})}else{$(eId).sortable()}$(eId).disableSelection();var sMode='mode_'+mode;document.getElementById('SaveBtn').style.display='';document.getElementById('SortBtn').style.display='none';document.getElementById('ListBtn').style.display='';document.getElementById('AddBtn').style.display='none';document.getElementById('FuncPane').className='FuncPane';if(mode==0){document.getElementById('VMNav').className='VM VM_Nav';document.getElementById('VMPages').className='VMSelected VM VM_Pages'}else{document.getElementById('VMNav').className='VMSelected VM VM_Nav';document.getElementById('VMPages').className='VM VM_Pages';document.getElementById('FuncPane').className='XMenusSort FuncPane'}}function fSimpleSort(eid,mode){$(eid).sortable({axis:"y"});var handle=$(eid).sortable("option","handle");$(eid).sortable("option","handle",".Sort");document.getElementById('FuncPane').className='FuncPane'}function fSortFiles(eId,mode){fHideElems('XPageDoc');$('#XPageSortDoc').fadeIn(1000);$(eId).sortable({axis:"y"});$(eId).disableSelection();var sMode='mode_'+mode;document.getElementById('SaveBtn').style.display='';document.getElementById('SortBtn').style.display='none';document.getElementById('ListBtn').style.display='';document.getElementById('AddBtn').style.display='none';document.getElementById('FuncPane').className='FuncPane';if(mode==0){document.getElementById('VMNav').className='VM VM_Nav';document.getElementById('VMPages').className='VMSelected VM VM_Pages'}else{document.getElementById('VMNav').className='VMSelected VM VM_Nav';document.getElementById('VMPages').className='VM VM_Pages';document.getElementById('FuncPane').className='XMenusSort FuncPane'}}function fDisableSortPages(eId,mode){fHideElems('XPageDoc');$('#XPageListDoc').fadeIn(1000);fDestroyDroppable(eId);document.getElementById('SaveBtn').style.display='none';document.getElementById('SortBtn').style.display='';document.getElementById('ListBtn').style.display='none';document.getElementById('AddBtn').style.display='';document.getElementById('FuncPane').className='FuncPane';if(mode==0){document.getElementById('VMNav').className='VM VM_Nav';document.getElementById('VMPages').className='VMSelected VM VM_Pages'}else{document.getElementById('VMNav').className='VMSelected VM VM_Nav';document.getElementById('VMPages').className='VM VM_Pages'}}function fDestroyDroppable(eId){try{$(eId).sortable("destroy")}catch(e){};try{$(eId).droppable("destroy")}catch(e){}}function fSetFuncPane(elemId,explainId){document.getElementById('divWidgetArea').style.display='';document.getElementById('divWidgetContainer').style.display='none';fHideElems('XPFuncs','div');$('#'+elemId).fadeIn(1000);fHideElems('XPageDoc');if(explainId){$('#'+explainId).fadeIn(1000)}}function fBuildNav(activeMode,pageMode){document.getElementById('InactiveSortableList').innerHTML='';document.getElementById('xf_SortType').value='0';if(pageMode==0){document.getElementById('SaveBtn').style.display='none';document.getElementById('SortBtn').style.display='';document.getElementById('ListBtn').style.display='none';document.getElementById('AddBtn').style.display=''}else{document.getElementById('SaveBtn').style.display='';document.getElementById('SortBtn').style.display='none';document.getElementById('ListBtn').style.display='none';document.getElementById('AddBtn').style.display=''}eval(document.getElementById('divJSONDoc').innerHTML);var sHTML='';if(oDANav.length>0){for(i=0;i<oDANav.length;i++){if((oDANav[i]['Active']==activeMode&&pageMode=='1')||pageMode==0){sHTML=sHTML+' <li class="StdRow StdList" id="Row_'+oDANav[i]['PageId']+'">'+'              <div class="SortableRow">'+'                 <div class="Controls">'+'                     <div class="Edit" title="Edit XPage"><a href="/ONEXPAGE?pid='+oDANav[i]['PageId']+'"><img src="/images/spacer.gif"/></a></div>'+'                     <div class="Delete" title="Delete XPage"><a href="javascript:void(0);" onclick="fDelPage('+oDANav[i]['PageId']+');"><img src="/images/spacer.gif"/></a></div>'+'                     <div class="Sort" title="Sort XPage"><a href="javascript:void(0);"><img src="/images/spacer.gif"/></a></div>'+'                     <br class="ClearFloat"/>'+'                 </div>'+'                 <div class="Title">'+oDANav[i]['Title']+'</div>'+'                 <br class="ClearFloat"/>'+'              </div>'+'          </li>'}}}if(sHTML.length<1){if(pageMode==0){sHTML='      <li class=InfoMsg>There are no XPages on file at this time</li>'}else{sHTML='      <li class=PlaceHolder><div class=Title>Drop your menu options here</div></li>'}}if(activeMode==1){document.getElementById('SortableList').innerHTML=sHTML}else{document.getElementById('InactiveSortableList').innerHTML=sHTML}}function fSelectMainFunc(elemId){pars=document.getElementById('NavPane').getElementsByTagName('div');for(i=0;i<pars.length;i++){if(pars[i].className.indexOf('VM')!=-1){var newClassName=pars[i].className.replace('VMSelected','');pars[i].className=newClassName}}document.getElementById(elemId).className='VMSelected '+document.getElementById(elemId).className}function fHideElems(className,selector){if(!selector){selector='p'}pars=document.getElementsByTagName(selector);for(i=0;i<pars.length;i++){if(pars[i].className.indexOf(className)!=-1){pars[i].style.display='none'}}}function fAddFileHouseKeeping(){$('#NewFile').fadeOut();document.getElementById('FileName').value='';document.getElementById('RelativePath').value='';document.getElementById('Description').value=''}function fSaveSortPages(event){fSerializeSortPages();event.preventDefault();var $form=$(this),url=$form.attr('action');var posting=$.post(url,$('#formSort').serialize());posting.done(function(){fBuildStdMsg('Updated')})}function fSaveBasicPage(event,elem,msg){if(!msg){msg='Updated'}event.preventDefault();var $form=$(this),url=$form.attr('action');var posting=$.post(url,$('#'+elem).serialize());posting.done(function(){fBuildStdMsg(msg);if(document.getElementById('CallBack')){eval(document.getElementById('CallBack').value)}})}function fBuildStreamMsg(sText){document.getElementById('StdMsg').style.visibity='visible';document.getElementById('StdMsg').style.display='';document.getElementById('StdMsg').innerHTML=document.getElementById('StdMsg').innerHTML+'<p>'+sText+'</p>'}function fBuildStdMsg(sText){if(sText==-1){return}document.getElementById('StdMsg').innerHTML=sText;var selectedEffect=$("#effectTypes").val();var options={};$("#StdMsg").show('fade',options,500,callback);function callback(){setTimeout(function(){$("#StdMsg:visible").removeAttr("style").fadeOut()},3000)}}function fSerializeSortPages(){var aId='';var sDelim='';var sId='';pars=document.getElementById('SortableList').getElementsByTagName('li');for(i=0;i<pars.length;i++){if(pars[i].id.indexOf('Row_')!=-1){sId=pars[i].id;sId=sId.replace('Row_','');aId=aId+sDelim+sId;sDelim=','}}pars=document.getElementById('InactiveSortableList').getElementsByTagName('li');for(i=0;i<pars.length;i++){if(pars[i].id.indexOf('Row_')!=-1){sId=pars[i].id;sId=sId.replace('Row_','');aId=aId+sDelim+sId+'_';sDelim=','}}document.getElementById('SortArray').value=aId}function fInitNavDrag(){document.getElementById('xf_SortType').value='1';document.getElementById('VMNav').className='VMSelected VM VM_Nav';document.getElementById('VMPages').className='VM VM_Pages';document.getElementById('FuncPane').className='XMenusSort FuncPane';$("#InactiveSortableList").sortable({connectWith:"#SortableList"});$("#SortableList").sortable({connectWith:"#InactiveSortableList"})}function fSetUpDragDrop(dragElemAttr,dropElemAttr){return;$(dragElemAttr).draggable({appendTo:"body",cursor:"crosshair"});$(dropElemAttr).droppable({activeClass:"ui-state-default",hoverClass:"ui-state-hover",accept:":not(.ui-sortable-helper)",drop:function(event,ui){$(this).find(".PlaceHolder").remove();$("<li></li>").html(ui.draggable.html()).addClass('StdList').addClass('StdRow').insertBefore($(this).find("#BaseClearFloat"));$(ui.draggable).remove()}}).sortable({items:"li:not(.PlaceHolder)",sort:function(){$(this).removeClass("ui-state-default")}})}function fSetCPSwatch(elem,className,optName){if(optName){document.getElementById('CurrentArea').innerHTML='Currently styling: '+optName}else{document.getElementById('CurrentArea').innerHTML='Currently styling: '+elem.innerHTML}pars=document.getElementById('Layout1').getElementsByTagName('div');for(i=0;i<pars.length;i++){pars[i].className=pars[i].className.replace('swatch','')}for(i=0;i<pars.length;i++){if(pars[i].className.indexOf(className)!=-1){pars[i].className=pars[i].className+' swatch'}}}function fInitColorPickers(){$(function(){$("#tabs").tabs()});function hexFromRGB(r,g,b){var hex=[r.toString(16),g.toString(16),b.toString(16)];$.each(hex,function(nr,val){if(val.length===1){hex[nr]="0"+val}});return hex.join("").toUpperCase()}function refreshSwatch(){var red=$("#red").slider("value"),green=$("#green").slider("value"),blue=$("#blue").slider("value"),hex=hexFromRGB(red,green,blue);$(".swatch").css("background-color","#"+hex)}$(function(){$("#red, #green, #blue").slider({orientation:"horizontal",range:"min",max:255,value:127,slide:refreshSwatch,change:refreshSwatch});$("#red").slider("value",255);$("#green").slider("value",140);$("#blue").slider("value",60)})}function fLoadWidget(widget,params){switch(widget){case 0:case 1:document.getElementById('divWidgetArea').style.display='none';$('#divWidgetContainer').load('/OXPFUNCS.php?FUNC=FS'+params,function(){fSimpleSort('#SortableList2',0)});$('#divWidgetContainer').fadeIn();break}}function fGetEditorHTML(event,elem){var myinstances=[];for(var i in CKEDITOR.instances){CKEDITOR.instances[i];CKEDITOR.instances[i].name;CKEDITOR.instances[i].value;CKEDITOR.instances[i].updateElement();myinstances[CKEDITOR.instances[i].name]=CKEDITOR.instances[i].getData();CKEDITOR.instances[i].destroy()}var pars=document.getElementsByTagName('*');var sAllHTML='';var sAllIds='';var sDelim='';var sComma='';for(i=0;i<pars.length;i++){if(pars[i].id){if(pars[i].id.indexOf('XPageContainer_')==0){var sA=pars[i].id.split('_');document.getElementById('XPG_HTML').value=pars[i].innerHTML;document.getElementById('XPG_IDS').value=sA[1];fSaveBasicPage(event,'formAllHTML',-1)}}}}function fDisplayShadowBox(){document.getElementById('divShadowCurtain').style.display='';document.getElementById('HTMLBody').style.overflow='hidden';if(window.pageYOffset){var h=document.getElementById('HTMLBody').scrollHeight}else{var h=document.body.scrollHeight+document.body.scrollTop}if(window.pageYOffset){posY=window.pageYOffset}else{posY=document.body.scrollTop}}